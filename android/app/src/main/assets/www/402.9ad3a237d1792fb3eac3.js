"use strict";(self.webpackChunksosgame=self.webpackChunksosgame||[]).push([[402],{510:(e,t,r)=>{r.d(t,{A:()=>n});const n=function(e){return{message:e.onMessage}}},940:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(746);function o(){}function i(e,t){return e.wh?e.wh:"https:"!==t.protocol?"ws://"+t.hostname+":"+e.wsPort:void 0}function s(e,t){const r=(0,n.A)(["close","disconnect","error","join","gameinit","reconnect"]);let s,a={};return{connect:function(i){return new Promise(((u,l)=>{if(!i)return void l("Can't determine ws address");const c=function(e,t,r){const i=(0,n.A)(["error","open","message","beforeclose","close"]),s=new WebSocket(t);function a(e){r.log("Websocket message received: "+e);const t=JSON.parse(e);return i.call("message",t)}return s.onopen=function(){return i.call("open",e)},s.onclose=function(t){return r.log("Websocket closed "+t.code+" "+t.reason),i.call("close",e)},s.onmessage=async function(e){return e.data instanceof Blob?a(await e.data.text()):a(e.data)},s.onerror=function(t){return r.error(t),i.call("error",e)},{on:(e,t)=>i.on(e,t),send:(t,n,o,i)=>{const a={from:e,to:o,action:t,data:n,ignore:i};return r.log("Sending ["+e+"] to ["+o+"]: "+JSON.stringify(n)),s.send(JSON.stringify(a))},close:async()=>(await i.call("beforeclose",e),s.onerror=o,s.close())}}(e,i,t);c.on("error",(e=>{t.log("Connection to ws error "+e),l(e)})),c.on("message",(n=>{if(n.from!==e)if(n.to===e||"all"===n.to){if(!(n.ignore&&Array.isArray(n.ignore)&&n.ignore.includes(e)))return r.actionKeys().includes(n.action)?(t.log("handlers.actionKeys"),r.call(n.action,n)):Object.keys(a).includes(n.action)?(t.log("callCurrentHandler"),function(e,r){const n=a[e];"function"==typeof n?s?s.add((()=>n(r.data,r.from))):t.log("No queue"):t.log("Not function")}(n.action,n)):void t.log("Unknown action "+n.action);t.log("user in ignore list")}else t.log("another user");else t.error("same user")}));const d=(e,r,n)=>(t.log(r),c.send(e,r,"all",n)),h=(e,t,r)=>c.send(e,t,r);c.on("open",(()=>u({sendRawAll:d,sendRawTo:h})))}))},on:function(e,t){return r.on(e,t)},getWebSocketUrl:i,registerHandler:function(e,t){s=t,a=e}}}},189:(e,t,r)=>{r.d(t,{A:()=>c});const n=-1,o=1,i=2,s=3;function a(e){switch(e){case 5:return"S";case 2:return"O";case 0:return" "}return""}function u(e){return Array.from({length:e}).fill(0)}function l(e){const t=[5,2],r=[-1,-1,...e,-1,-1],u=r.length-4,c=e=>e>=0&&e<u,d=e=>{for(let t=e+2;t<e+5;++t){if(5===r[t-2]&&2===r[t-1]&&5===r[t])return s}for(let e=0;e<u;e++)if(0===r[e+2])return o;return i},h=e=>0===r[2+e],g=e=>c(e)&&h(e),f=()=>r.slice(2,-2);return{size:()=>u,setSafe:(e,t)=>g(t)?(((e,t)=>{r[2+t]=function(e){switch(e){case"S":case"s":return 5;case"O":case"o":return 2;case" ":return 0;case"":return-1}return-1}(e)})(e,t),d(t)):n,setSafeByIndex:(e,o,i=!1)=>{if(!g(o))return n;if(e<0||e>=t.length)return n;const s=r[2+o];r[2+o]=t[e];const a=d(o);return i&&(r[2+o]=s),a},getCharSafe:e=>c(e)?(e=>a(r[2+e]))(e):"",canSet:g,clone:()=>l(e),movesLeft:()=>r.reduce(((e,t)=>e+(0===t)),0),toArr:f,asString:()=>f().map(a).join(""),isEmpty:h,inBounds:c,checkWinning:d}}const c={defaultField:function(e){return l(u(e))},field:l,init:u,IMPOSSIBLE_MOVE:n,NORMAL_MOVE:o,WINNING_MOVE:s,DRAW_MOVE:i}},657:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(379);function o(e,t=0){const r=[];for(const[t]of Object.entries(e))r.push(t);let o=r.length;const i=t=>{const o=r[t];(0,n.vA)(o,"Bad Index");const i=e[o];return(0,n.vA)(i,"Empty client"),i},s=t=>{const r=e[t];return(0,n.vA)(r,`No id ${t} in clients`),r},a=(e,t)=>{const n=e.index,o=r[n];r[e.index]=r[t.index],e.index=t.index,r[t.index]=o,t.index=n},u=e=>(e+r.length)%r.length;return{addClient:(t,i)=>{const s=e[t];s?s.name=i:(e[t]={index:o,name:i},r.push(t),++o),(0,n.vA)(o===r.length)},remove:t=>{const i=e[t];--o;const s=r[o];r[i.index]=s,r.pop();e[s].index=i.index,e[t]=void 0,(0,n.vA)(o===r.length)},swapInd:(e,t)=>{const r=i(e),n=i(t);a(r,n)},swapById:(e,t)=>{const r=s(e),n=s(t);a(r,n)},indById:e=>u(s(e).index+t),idByInd:e=>r[u(e-t)],size:()=>r.length}}},666:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(379),o=r(272);const i={setupLogger:function(e,t){let r;t.logger&&(r=e.querySelector(t.logger));return function(e,t){return{log:r=>{if(t.networkDebug)return(0,n.Rm)(r,e)},error:t=>{if(e)return(0,n.z3)(t,e)}}}(r,t)},getMyId:function(e,t,r){const n=e.sessionStorage.getItem(t.idNameInStorage);if(n)return n;const i=o.A.makeId(t.idNameLen,r);e.sessionStorage.setItem(t.idNameInStorage,i)},setupMedia:function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}}},402:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(233),o=r(510),i=r(940),s=r(657),a=r(666),u=r(373);function l(e){this.mode=d.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,r=this.data.length;t<r;t++){var n=[],o=this.data.charCodeAt(t);o>65536?(n[0]=240|(1835008&o)>>>18,n[1]=128|(258048&o)>>>12,n[2]=128|(4032&o)>>>6,n[3]=128|63&o):o>2048?(n[0]=224|(61440&o)>>>12,n[1]=128|(4032&o)>>>6,n[2]=128|63&o):o>128?(n[0]=192|(1984&o)>>>6,n[1]=128|63&o):n[0]=o,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function c(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}l.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}},c.prototype={addData:function(e){var t=new l(e);this.dataList.push(t),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[r][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=c.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(var n=-1;n<=7;n++)t+n<=-1||this.moduleCount<=t+n||(this.modules[e+r][t+n]=0<=r&&r<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=n&&n<=4)},getBestMaskPattern:function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var n=E.getLostPoint(this);(0==r||e>n)&&(e=n,t=r)}return t},createMovieClip:function(e,t,r){var n=e.createEmptyMovieClip(t,r);this.make();for(var o=0;o<this.modules.length;o++)for(var i=1*o,s=0;s<this.modules[o].length;s++){var a=1*s;this.modules[o][s]&&(n.beginFill(0,100),n.moveTo(a,i),n.lineTo(a+1,i),n.lineTo(a+1,i+1),n.lineTo(a,i+1),n.endFill())}return n},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=E.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var n=e[t],o=e[r];if(null==this.modules[n][o])for(var i=-2;i<=2;i++)for(var s=-2;s<=2;s++)this.modules[n+i][o+s]=-2==i||2==i||-2==s||2==s||0==i&&0==s}},setupTypeNumber:function(e){for(var t=E.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var n=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=n}for(r=0;r<18;r++){n=!e&&1==(t>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=n}},setupTypeInfo:function(e,t){for(var r=this.errorCorrectLevel<<3|t,n=E.getBCHTypeInfo(r),o=0;o<15;o++){var i=!e&&1==(n>>o&1);o<6?this.modules[o][8]=i:o<8?this.modules[o+1][8]=i:this.modules[this.moduleCount-15+o][8]=i}for(o=0;o<15;o++){i=!e&&1==(n>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=i:o<9?this.modules[8][15-o-1+1]=i:this.modules[8][15-o-1]=i}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var r=-1,n=this.moduleCount-1,o=7,i=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var a=0;a<2;a++)if(null==this.modules[n][s-a]){var u=!1;i<e.length&&(u=1==(e[i]>>>o&1)),E.getMask(t,n,s-a)&&(u=!u),this.modules[n][s-a]=u,-1==--o&&(i++,o=7)}if((n+=r)<0||this.moduleCount<=n){n-=r,r=-r;break}}}},c.PAD0=236,c.PAD1=17,c.createData=function(e,t,r){for(var n=B.getRSBlocks(e,t),o=new D,i=0;i<r.length;i++){var s=r[i];o.put(s.mode,4),o.put(s.getLength(),E.getLengthInBits(s.mode,e)),s.write(o)}var a=0;for(i=0;i<n.length;i++)a+=n[i].dataCount;if(o.getLengthInBits()>8*a)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*a+")");for(o.getLengthInBits()+4<=8*a&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*a||(o.put(c.PAD0,8),o.getLengthInBits()>=8*a));)o.put(c.PAD1,8);return c.createBytes(o,n)},c.createBytes=function(e,t){for(var r=0,n=0,o=0,i=new Array(t.length),s=new Array(t.length),a=0;a<t.length;a++){var u=t[a].dataCount,l=t[a].totalCount-u;n=Math.max(n,u),o=Math.max(o,l),i[a]=new Array(u);for(var c=0;c<i[a].length;c++)i[a][c]=255&e.buffer[c+r];r+=u;var d=E.getErrorCorrectPolynomial(l),h=new C(i[a],d.getLength()-1).mod(d);s[a]=new Array(d.getLength()-1);for(c=0;c<s[a].length;c++){var g=c+h.getLength()-s[a].length;s[a][c]=g>=0?h.get(g):0}}var f=0;for(c=0;c<t.length;c++)f+=t[c].totalCount;var m=new Array(f),v=0;for(c=0;c<n;c++)for(a=0;a<t.length;a++)c<i[a].length&&(m[v++]=i[a][c]);for(c=0;c<o;c++)for(a=0;a<t.length;a++)c<s[a].length&&(m[v++]=s[a][c]);return m};for(var d={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},h={L:1,M:0,Q:3,H:2},g=0,f=1,m=2,v=3,p=4,w=5,A=6,y=7,E={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;E.getBCHDigit(t)-E.getBCHDigit(E.G15)>=0;)t^=E.G15<<E.getBCHDigit(t)-E.getBCHDigit(E.G15);return(e<<10|t)^E.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;E.getBCHDigit(t)-E.getBCHDigit(E.G18)>=0;)t^=E.G18<<E.getBCHDigit(t)-E.getBCHDigit(E.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return E.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case g:return(t+r)%2==0;case f:return t%2==0;case m:return r%3==0;case v:return(t+r)%3==0;case p:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case w:return t*r%2+t*r%3==0;case A:return(t*r%2+t*r%3)%2==0;case y:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new C([1],0),r=0;r<e;r++)t=t.multiply(new C([1,I.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case d.MODE_NUMBER:return 10;case d.MODE_ALPHA_NUM:return 9;case d.MODE_8BIT_BYTE:case d.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case d.MODE_NUMBER:return 12;case d.MODE_ALPHA_NUM:return 11;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case d.MODE_NUMBER:return 14;case d.MODE_ALPHA_NUM:return 13;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,n=0;n<t;n++)for(var o=0;o<t;o++){for(var i=0,s=e.isDark(n,o),a=-1;a<=1;a++)if(!(n+a<0||t<=n+a))for(var u=-1;u<=1;u++)o+u<0||t<=o+u||0==a&&0==u||s==e.isDark(n+a,o+u)&&i++;i>5&&(r+=3+i-5)}for(n=0;n<t-1;n++)for(o=0;o<t-1;o++){var l=0;e.isDark(n,o)&&l++,e.isDark(n+1,o)&&l++,e.isDark(n,o+1)&&l++,e.isDark(n+1,o+1)&&l++,0!=l&&4!=l||(r+=3)}for(n=0;n<t;n++)for(o=0;o<t-6;o++)e.isDark(n,o)&&!e.isDark(n,o+1)&&e.isDark(n,o+2)&&e.isDark(n,o+3)&&e.isDark(n,o+4)&&!e.isDark(n,o+5)&&e.isDark(n,o+6)&&(r+=40);for(o=0;o<t;o++)for(n=0;n<t-6;n++)e.isDark(n,o)&&!e.isDark(n+1,o)&&e.isDark(n+2,o)&&e.isDark(n+3,o)&&e.isDark(n+4,o)&&!e.isDark(n+5,o)&&e.isDark(n+6,o)&&(r+=40);var c=0;for(o=0;o<t;o++)for(n=0;n<t;n++)e.isDark(n,o)&&c++;return r+=10*(Math.abs(100*c/t/t-50)/5)}},I={glog:function(e){if(e<1)throw new Error("glog("+e+")");return I.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return I.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},M=0;M<8;M++)I.EXP_TABLE[M]=1<<M;for(M=8;M<256;M++)I.EXP_TABLE[M]=I.EXP_TABLE[M-4]^I.EXP_TABLE[M-5]^I.EXP_TABLE[M-6]^I.EXP_TABLE[M-8];for(M=0;M<255;M++)I.LOG_TABLE[I.EXP_TABLE[M]]=M;function C(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+t);for(var n=0;n<e.length-r;n++)this.num[n]=e[n+r]}function B(e,t){this.totalCount=e,this.dataCount=t}function D(){this.buffer=[],this.length=0}C.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var n=0;n<e.getLength();n++)t[r+n]^=I.gexp(I.glog(this.get(r))+I.glog(e.get(n)));return new C(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=I.glog(this.get(0))-I.glog(e.get(0)),r=new Array(this.getLength()),n=0;n<this.getLength();n++)r[n]=this.get(n);for(n=0;n<e.getLength();n++)r[n]^=I.gexp(I.glog(e.get(n))+t);return new C(r,0).mod(e)}},B.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],B.getRSBlocks=function(e,t){var r=B.getRsBlockTable(e,t);if(null==r)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var n=r.length/3,o=[],i=0;i<n;i++)for(var s=r[3*i+0],a=r[3*i+1],u=r[3*i+2],l=0;l<s;l++)o.push(new B(a,u));return o},B.getRsBlockTable=function(e,t){switch(t){case h.L:return B.RS_BLOCK_TABLE[4*(e-1)+0];case h.M:return B.RS_BLOCK_TABLE[4*(e-1)+1];case h.Q:return B.RS_BLOCK_TABLE[4*(e-1)+2];case h.H:return B.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},D.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var L=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function x(e){if(this.options={padding:4,width:256,height:256,typeNumber:4,color:"#000000",background:"#ffffff",ecl:"M"},"string"==typeof e&&(e={content:e}),e)for(var t in e)this.options[t]=e[t];if("string"!=typeof this.options.content)throw new Error("Expected 'content' as string!");if(0===this.options.content.length)throw new Error("Expected 'content' to be non-empty!");if(!(this.options.padding>=0))throw new Error("Expected 'padding' value to be non-negative!");if(!(this.options.width>0&&this.options.height>0))throw new Error("Expected 'width' or 'height' value to be higher than zero!");var r=this.options.content,n=function(e,t){for(var r=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}(e),n=1,o=0,i=0,s=L.length;i<=s;i++){var a=L[i];if(!a)throw new Error("Content too long: expected "+o+" but got "+r);switch(t){case"L":o=a[0];break;case"M":o=a[1];break;case"Q":o=a[2];break;case"H":o=a[3];break;default:throw new Error("Unknwon error correction level: "+t)}if(r<=o)break;n++}if(n>L.length)throw new Error("Content too long");return n}(r,this.options.ecl),o=function(e){switch(e){case"L":return h.L;case"M":return h.M;case"Q":return h.Q;case"H":return h.H;default:throw new Error("Unknwon error correction level: "+e)}}(this.options.ecl);this.qrcode=new c(n,o),this.qrcode.addData(r),this.qrcode.make()}x.prototype.svg=function(e){var t=this.options||{},r=this.qrcode.modules;void 0===e&&(e={container:t.container||"svg"});for(var n=void 0===t.pretty||!!t.pretty,o=n?"  ":"",i=n?"\r\n":"",s=t.width,a=t.height,u=r.length,l=s/(u+2*t.padding),c=a/(u+2*t.padding),d=void 0!==t.join&&!!t.join,h=void 0!==t.swap&&!!t.swap,g=void 0===t.xmlDeclaration||!!t.xmlDeclaration,f=void 0!==t.predefined&&!!t.predefined,m=f?o+'<defs><path id="qrmodule" d="M0 0 h'+c+" v"+l+' H0 z" style="fill:'+t.color+';shape-rendering:crispEdges;" /></defs>'+i:"",v=o+'<rect x="0" y="0" width="'+s+'" height="'+a+'" style="fill:'+t.background+';shape-rendering:crispEdges;"/>'+i,p="",w="",A=0;A<u;A++)for(var y=0;y<u;y++){if(r[y][A]){var E=y*l+t.padding*l,I=A*c+t.padding*c;if(h){var M=E;E=I,I=M}if(d){var C=l+E,B=c+I;E=Number.isInteger(E)?Number(E):E.toFixed(2),I=Number.isInteger(I)?Number(I):I.toFixed(2),C=Number.isInteger(C)?Number(C):C.toFixed(2),w+="M"+E+","+I+" V"+(B=Number.isInteger(B)?Number(B):B.toFixed(2))+" H"+C+" V"+I+" H"+E+" Z "}else p+=f?o+'<use x="'+E.toString()+'" y="'+I.toString()+'" href="#qrmodule" />'+i:o+'<rect x="'+E.toString()+'" y="'+I.toString()+'" width="'+l+'" height="'+c+'" style="fill:'+t.color+';shape-rendering:crispEdges;"/>'+i}}d&&(p=o+'<path x="0" y="0" style="fill:'+t.color+';shape-rendering:crispEdges;" d="'+w+'" />');var D="";switch(e.container){case"svg":g&&(D+='<?xml version="1.0" standalone="yes"?>'+i),D+='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+s+'" height="'+a+'">'+i,D+=m+v+p,D+="</svg>";break;case"svg-viewbox":g&&(D+='<?xml version="1.0" standalone="yes"?>'+i),D+='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+s+" "+a+'">'+i,D+=m+v+p,D+="</svg>";break;case"g":D+='<g width="'+s+'" height="'+a+'">'+i,D+=m+v+p,D+="</g>";break;default:D+=(m+v+p).replace(/^\s+/,"")}return D};const k=function(e,t){const r=new x({content:e,container:"svg-viewbox",join:!0}).svg();var n;return t.innerHTML=r,(n=t).addEventListener("click",(()=>n.classList.toggle("big"))),t};var b=r(379);function P(e,t){const r={serverId:t};return e.sendRawAll("reconnect",r)}function _(e,t,r,n,i,s){const a=(0,o.A)(e);return t.registerHandler(a,i),function(e,t,r,n){for(const r of e.actionKeys())e.on(r,(e=>{let o;e&&void 0!==e.playerId&&(o=[n.idByInd(e.playerId)]),t.sendRawAll(r,e,o)}));return P(t,r)}(e,r,n,s)}function O(e,t,r,o){return new Promise(((l,c)=>{const d=a.A.getMyId(e,r,Math.random),h=a.A.setupLogger(t,r),g=(0,i.A)(d,h),f=(0,n.A)(h),m=u.A.presenterFuncDefault(r),v=o(e,t,r,m),p=(0,s.A)({},m.getClientIndex());p.addClient(d,d),g.connect(g.getWebSocketUrl(r,e.location)).then((n=>{const o=function(e,t,r){const n=r.sh||e.location.href,o=new URL(n);return o.searchParams.set("mode","client"),k(o.toString(),t.querySelector(".qrcode"))}(e,t,r);v.on("started",(()=>{(0,b.k6)(o)})),v.on("winclosed",(()=>(m.nextRound(),v.redraw(),P(n,d)))),g.on("join",(e=>{p.addClient(e.from,e.from);const t=p.indById(e.from),i=p.indById(d);p.size()===r.playerLimit&&m.isGameOver()&&m.resetRound();const s=m.toJson(t),a={serverId:d,joinedInd:t,serverInd:i,presenter:s};n.sendRawTo("gameinit",a,e.from),v.redraw(),(0,b.k6)(o)})),_(v,g,n,d,f,p),l(v)})).catch((e=>{h.error(e),c(e)}))}))}},373:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(189),o=r(746);function i(e,t,r,n,o){const i=r;let s="";return o>=0&&o<n.length&&(s=n[o]),{isLastMove:e,isActive:t,text:i,color:s}}function s(e){return{clientUserIdx:e.colorOrder.indexOf(e.color),currentUserIdx:0,playersSize:e.playerLimit,activeCellIndex:-1,activeDigitIndex:-1,lastMove:-1,gameover:!0,round:0,moveCount:0,fieldArr:n.A.init(e.size),movesIdx:Array.from({length:e.size}).fill(-1)}}function a({currentUserIdx:e,clientUserIdx:t,playersSize:r,activeCellIndex:s,activeDigitIndex:a,lastMove:u,gameover:l,round:c,moveCount:d,fieldArr:h,movesIdx:g},f){let m=n.A.field(h);const v=(0,o.A)(["moveEnd","nextPlayer","gameover"]);const p=()=>{e=(e+1)%r},w=async function(r,o,i){if(!((e,t,r,n)=>!(t<0||t>=2)&&r===n&&m.canSet(e))(r,o,i,e))return{res:n.A.IMPOSSIBLE_MOVE,position:-1,digit:-1,playerId:e,clientId:i};const c=m.setSafeByIndex(o,r);if(c===n.A.IMPOSSIBLE_MOVE)return{res:c,position:-1,digit:-1,playerId:e,clientId:i};s=-1,a=-1,g[r]=i,u=r,++d;const h=e,f=t;return await v.call("moveEnd",{res:c,position:r,digit:o,playerId:h,clientId:f,moveCount:d}),c===n.A.NORMAL_MOVE&&(p(),await v.call("nextPlayer",{res:c,position:r,digit:o,playerId:h,clientId:f,moveCount:d})),c!==n.A.WINNING_MOVE&&c!==n.A.DRAW_MOVE||(l=!0,await v.call("gameover",{res:c,position:r,digit:o,playerId:h,clientId:f,moveCount:d})),{res:c,position:r,digit:o,playerId:h,clientId:f}},A=m.size,y=()=>f.colorOrder[e],E=()=>{d=0,l=!1,s=-1,a=-1,u=-1,h=n.A.init(A()),g=Array.from({length:A()}).fill(-1),e=c%r,m=n.A.field(h)};return{on:function(e,t){return v.on(e,t)},size:A,tryMove:function(){return w(s,a,e)},setMove:w,enum1:()=>function*(){for(let e=0;e<m.size();++e)yield[e,i(u===e,s===e,m.getCharSafe(e),f.colorOrder,g[e])]}(),setActivePosition:function(r){t!==e||l||(s=m.canSet(r)?r:-1)},setActiveDigitIndex:function(r){t!==e||l||(a=r)},currentColor:y,getActiveDigitIndex:()=>a,endMessage:r=>r===n.A.DRAW_MOVE?"Draw":e!==t?"You lose":"You win",endMessage2:e=>e===n.A.DRAW_MOVE?"Draw":y()+" player win",toJson:t=>({currentUserIdx:e,clientUserIdx:t,playersSize:r,activeCellIndex:s,activeDigitIndex:a,lastMove:u,gameover:l,fieldArr:m.toArr(),movesIdx:g}),isGameOver:()=>l,isMyMove:()=>!l&&e===t,calcLastMoveRes:()=>{if(u<0)return n.A.IMPOSSIBLE_MOVE;return m.checkWinning(u)},getCurrentIndex:()=>e,setClientIndex:e=>{t=e},getClientIndex:()=>t,getPlayersSize:()=>r,setMyTurn:()=>{e=t},nextRound:()=>{++c,E()},resetRound:E}}const u={presenterFunc:a,defaultPresenter:s,presenterFuncDefault:function(e){return a(s(e),e)}}},233:(e,t,r)=>{function n(e){let t=Promise.resolve();return{add:r=>new Promise(((n,o)=>{t=t.then(r).then(n).catch((t=>{e.log(t),o(t)}))}))}}r.d(t,{A:()=>n})},272:(e,t,r)=>{function n(e){return function(e,t){const r=e+Math.random()*(t-e);return Math.floor(r)}(0,e)}r.d(t,{A:()=>o});const o={makeId:function(e,t){let r="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let o=0;o<e;o++)r+=n.charAt(Math.floor(62*t()));return r},randomEl:function(e){return e[n(e.length)]}}}}]);