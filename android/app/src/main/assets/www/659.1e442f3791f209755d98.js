"use strict";(self.webpackChunksosgame=self.webpackChunksosgame||[]).push([[659],{189:(e,t,n)=>{n.d(t,{A:()=>u});const r=-1,i=1,o=2,s=3;function c(e){switch(e){case 5:return"S";case 2:return"O";case 0:return" "}return""}function a(e){return Array.from({length:e}).fill(0)}function l(e){const t=[5,2],n=[-1,-1,...e,-1,-1],a=n.length-4,u=e=>e>=0&&e<a,d=e=>{for(let t=e+2;t<e+5;++t){if(5===n[t-2]&&2===n[t-1]&&5===n[t])return s}for(let e=0;e<a;e++)if(0===n[e+2])return i;return o},f=e=>0===n[2+e],I=e=>u(e)&&f(e),v=()=>n.slice(2,-2);return{size:()=>a,setSafe:(e,t)=>I(t)?(((e,t)=>{n[2+t]=function(e){switch(e){case"S":case"s":return 5;case"O":case"o":return 2;case" ":return 0;case"":return-1}return-1}(e)})(e,t),d(t)):r,setSafeByIndex:(e,i,o=!1)=>{if(!I(i))return r;if(e<0||e>=t.length)return r;const s=n[2+i];n[2+i]=t[e];const c=d(i);return o&&(n[2+i]=s),c},getCharSafe:e=>u(e)?(e=>c(n[2+e]))(e):"",canSet:I,clone:()=>l(e),movesLeft:()=>n.reduce(((e,t)=>e+(0===t)),0),toArr:v,asString:()=>v().map(c).join(""),isEmpty:f,inBounds:u,checkWinning:d}}const u={defaultField:function(e){return l(a(e))},field:l,init:a,IMPOSSIBLE_MOVE:r,NORMAL_MOVE:i,WINNING_MOVE:s,DRAW_MOVE:o}},659:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(373);function i(e,t,n,i){return new Promise((o=>{const s=r.A.presenterFuncDefault(n);s.setMyTurn();const c=i(e,t,n,s);s.on("nextPlayer",(e=>{s.setClientIndex(s.getCurrentIndex()),c.redraw()})),s.resetRound(),c.redraw(),o(c)}))}},373:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(189),i=n(746);function o(e,t,n,r,i){let o=n,s="";return i>=0&&i<r.length&&(s=r[i]),{isLastMove:e,isActive:t,text:o,color:s}}function s(e){return{clientUserIdx:e.colorOrder.indexOf(e.color),currentUserIdx:0,playersSize:e.playerLimit,activeCellIndex:-1,activeDigitIndex:-1,lastMove:-1,gameover:!0,round:0,moveCount:0,fieldArr:r.A.init(e.size),movesIdx:Array.from({length:e.size}).fill(-1)}}function c({currentUserIdx:e,clientUserIdx:t,playersSize:n,activeCellIndex:s,activeDigitIndex:c,lastMove:a,gameover:l,round:u,moveCount:d,fieldArr:f,movesIdx:I},v){let g=r.A.field(f);const A=(0,i.A)(["moveEnd","nextPlayer","gameover"]);const M=()=>{e=(e+1)%n},x=async function(n,i,o){if(!((e,t,n,r)=>!(t<0||t>=2)&&n===r&&g.canSet(e))(n,i,o,e))return{res:r.A.IMPOSSIBLE_MOVE,position:-1,digit:-1,playerId:e,clientId:o};const u=g.setSafeByIndex(i,n);if(u===r.A.IMPOSSIBLE_MOVE)return{res:u,position:-1,digit:-1,playerId:e,clientId:o};s=-1,c=-1,I[n]=o,a=n,++d;const f=e,v=t;return await A.call("moveEnd",{res:u,position:n,digit:i,playerId:f,clientId:v,moveCount:d}),u===r.A.NORMAL_MOVE&&(M(),await A.call("nextPlayer",{res:u,position:n,digit:i,playerId:f,clientId:v,moveCount:d})),u!==r.A.WINNING_MOVE&&u!==r.A.DRAW_MOVE||(l=!0,await A.call("gameover",{res:u,position:n,digit:i,playerId:f,clientId:v,moveCount:d})),{res:u,position:n,digit:i,playerId:f,clientId:v}},m=g.size,y=()=>v.colorOrder[e],p=()=>{d=0,l=!1,s=-1,c=-1,a=-1,f=r.A.init(m()),I=Array.from({length:m()}).fill(-1),e=u%n,g=r.A.field(f)};return{on:function(e,t){return A.on(e,t)},size:m,tryMove:function(){return x(s,c,e)},setMove:x,enum1:()=>function*(){for(let e=0;e<g.size();++e)yield[e,o(a===e,s===e,g.getCharSafe(e),v.colorOrder,I[e])]}(),setActivePosition:function(n){t!==e||l||(s=g.canSet(n)?n:-1)},setActiveDigitIndex:function(n){t!==e||l||(c=n)},currentColor:y,getActiveDigitIndex:()=>c,endMessage:n=>n===r.A.DRAW_MOVE?"Draw":e!==t?"You lose":"You win",endMessage2:e=>e===r.A.DRAW_MOVE?"Draw":y()+" player win",toJson:t=>({currentUserIdx:e,clientUserIdx:t,playersSize:n,activeCellIndex:s,activeDigitIndex:c,lastMove:a,gameover:l,fieldArr:g.toArr(),movesIdx:I}),isGameOver:()=>l,isMyMove:()=>!l&&e===t,calcLastMoveRes:()=>{if(a<0)return r.A.IMPOSSIBLE_MOVE;return g.checkWinning(a)},getCurrentIndex:()=>e,setClientIndex:e=>{t=e},getClientIndex:()=>t,getPlayersSize:()=>n,setMyTurn:()=>{e=t},nextRound:()=>{++u,p()},resetRound:p}}const a={presenterFunc:c,defaultPresenter:s,presenterFuncDefault:function(e){return c(s(e),e)}}}}]);