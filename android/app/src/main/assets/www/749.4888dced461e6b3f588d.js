"use strict";(self.webpackChunksosgame=self.webpackChunksosgame||[]).push([[749],{749(e,o,n){n.d(o,{default:()=>t});var r=n(130);function s(){}function t(e,o,n){const t=(0,r.A)(["error","open","message","beforeclose","close"]),c=new WebSocket(o),a=Promise.withResolvers(),{on:l,unsubscribe:i}=t;function u(e){n.log("Websocket message received: "+e);const o=JSON.parse(e);return t.call("message",o)}return c.onopen=function(){return a.resolve(e),t.call("open",e)},c.onclose=function(o){return n.log("Websocket closed "+o.code+" "+o.reason),t.call("close",e)},c.onmessage=async function(e){if(e.data instanceof Blob){return u(await e.data.text())}return u(e.data)},c.onerror=function(o){return n.error(o),a.reject(o),t.call("error",e)},{on:l,unsubscribe:i,send:(o,r,s,t)=>{const a={from:e,to:s,action:o,data:r,ignore:t};return n.log("Sending ["+e+"] to ["+s+"]: "+JSON.stringify(r)),c.send(JSON.stringify(a))},close:async()=>(a.reject("close"),await t.call("beforeclose",e),c.onerror=s,c.close()),ready:()=>a.promise}}}}]);