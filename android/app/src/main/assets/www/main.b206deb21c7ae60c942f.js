(()=>{"use strict";var e,t,o={233(e,t,o){function r(e,t){if(!e)throw new Error(t)}o.d(t,{v:()=>r})},130(e,t,o){o.d(t,{A:()=>n});var r=o(233);function n(e,t){const o={};let n=0;for(const t of e)o[t]={};const s=()=>Object.keys(o),a=e=>{const t=o[e];return(0,r.v)(void 0!==t,"No key "+e),t},c=e=>s().includes(e),i=(e,t)=>{(0,r.v)("function"==typeof t,"bad setup "+e);const o=a(e);++n;const s="key"+n;return o[s]=t,s},l=(e,o)=>{const n=a(e),s=Object.values(n);if(0===s.length)return Promise.resolve();const c=()=>{const t=s.map(e=>Promise.try(e,o));return(0,r.v)(s.length>0,"No handlers2 "+e),(0,r.v)(void 0!==t[0],"No handlers3 "+e),Promise.allSettled(t)};return t?t.add(c):c()};return{on:i,set:(e,t)=>{o[e]=t},call:l,reset:(e,t)=>{(0,r.v)(c(e),"No name for reset "+e),o[e]={},i(e,t)},getAction:e=>t=>l(e,t),hasAction:c,unsubscribe:(e,t)=>{delete a(e)[t]},unsubscribeAll:()=>{for(const t of e)o[t]={}},actionKeys:s}}},366(e,t,o){o.d(t,{c:()=>r,h:()=>n});const r=e=>new Promise(t=>setTimeout(t,e)),n=async e=>{throw await r(e),new Error("timeout "+e)}},530(e,t,o){function r(e,t,o,r,n){o||(o=t.logLevel),r&&"string"==typeof r&&(r=e.querySelector(r));const s=(o,r)=>{!r&&t.logger&&(r=e.querySelector(t.logger)),r&&(Error.isError(o)?o=o.toString():"object"==typeof o&&JSON&&JSON.stringify&&(o=JSON.stringify(o)),r.innerHTML+=o+"<br />")};return{log:(e,...n)=>{o<t.logLevel||s(e,r)},error:(e,...n)=>{o>=t.logLevel&&s(e,r)}}}o.d(t,{A:()=>r})}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return o[e].call(s.exports,s,s.exports,n),s.exports}n.m=o,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,o)=>(n.f[o](e,t),t),[])),n.u=e=>e+"."+{18:"6655e97ca24968389f00",85:"b0ec2c348a872237533b",281:"24e807fa89839b32be8f",334:"2c621ac7c191c3e23a28",368:"80841cd42a46d605eec7",370:"82f5b27b58b66baa7b4e",386:"68a7d11a173291efadce",470:"e47b01f4bcc0c6d821a3",641:"5dcc836726cd0bb6dd58",659:"6624d918e5e74759fb22",749:"4888dced461e6b3f588d",826:"3b657dc060f6a3d21276",877:"5de0a9944a71b901f8ed"}[e]+".js",n.miniCssF=e=>{},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="sosgame:",n.l=(o,r,s,a)=>{if(e[o])e[o].push(r);else{var c,i;if(void 0!==s)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+s){c=u;break}}c||(i=!0,(c=document.createElement("script")).charset="utf-8",n.nc&&c.setAttribute("nonce",n.nc),c.setAttribute("data-webpack",t+s),c.src=o),e[o]=[r];var f=(t,r)=>{c.onerror=c.onload=null,clearTimeout(m);var n=e[o];if(delete e[o],c.parentNode&&c.parentNode.removeChild(c),n&&n.forEach(e=>e(r)),t)return t(r)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),i&&document.head.appendChild(c)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={792:0};n.f.j=(t,o)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var s=new Promise((o,n)=>r=e[t]=[o,n]);o.push(r[2]=s);var a=n.p+n.u(t),c=new Error;n.l(a,o=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=o&&("load"===o.type?"missing":o.type),a=o&&o.target&&o.target.src;c.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",c.name="ChunkLoadError",c.type=s,c.request=a,r[1](c)}},"chunk-"+t,t)}};var t=(t,o)=>{var r,s,[a,c,i]=o,l=0;if(a.some(t=>0!==e[t])){for(r in c)n.o(c,r)&&(n.m[r]=c[r]);if(i)i(n)}for(t&&t(o);l<a.length;l++)s=a[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},o=self.webpackChunksosgame=self.webpackChunksosgame||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{function e(e){switch(e?.toLowerCase()?.trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"":case null:return!1;default:return Boolean(e)}}var t=n(530),o=n(233),r=n(130),s=n(366);function a(e){return e.preventDefault(),e.target.classList.contains("cell")||e.target.classList.contains("digit")?e.target.classList.contains("disabled")?-1:function(e){const t=e.target||e.srcElement;return Number.parseInt(t.dataset.num,10)-1}(e):-1}function c(e,t){for(let o=0;o<2;o++){const r=t.childNodes[o];e.isActiveDigit(o)?(r.classList.add("active"),r.classList.add(e.currentColor())):(r.classList.remove("active"),r.classList.remove(e.currentColor()))}}function i(e,t){const o=e.enum1();for(const[r,n]of o){const o=t.childNodes[r],s=n.text;o.textContent=s.toString()," "===o.textContent&&(o.innerHTML="&nbsp;"),o.className=s&&" "!==s?"cell disabled":"cell",n.isActive&&(o.classList.add("active"),o.classList.add(e.currentColor())),n.color&&o.classList.add(n.color),n.isLastMove&&o.classList.add("last")}}function l(e,t,n,l){const d=t.querySelector(".field"),u=t.querySelector(".box"),f=t.querySelector(".buttons"),m=t.querySelector(".install");t.documentElement.style.setProperty("--field-size",l.size());const p=(0,r.A)(["message","gameover","started","winclosed"]),v=p.on,b=function(e,t){const r=e.querySelector(".overlay"),n=e.querySelector(".close");return(0,o.v)(r,"No overlay"),(0,o.v)(n,"No close button"),n.addEventListener("click",e=>(e.preventDefault(),r.classList.remove("show"),t.call("winclosed",{})),!1),r}(t,p),h=p.actionKeys,g=()=>(function(e,t,o,r){i(e,t),c(e,o),e.isMyMove()?r.classList.remove("disabled"):r.classList.add("disabled")}(l,u,f,d),Promise.resolve());function y(){return l.tryMove()}l.on("moveEnd",async e=>{const t=[];0===e.moveCount&&t.push(p.call("started",e)),t.push(g()),await Promise.allSettled(t);const o=[];o.push((0,s.c)(200)),o.push(p.call("message",e)),await Promise.allSettled(o)}),l.on("nextPlayer",()=>{const e=[];return e.push((0,s.c)(100)),e.push(g()),Promise.allSettled(e)}),l.on("gameover",e=>{const t=[];return t.push(function(e,t,o,r,n){const s=t.endMessage(e);return o.querySelector("h2").textContent=s,o.querySelector(".content").textContent=t.endMessage2(e),o.classList.add("show"),r.classList.remove("hidden2"),n.classList.add("disabled"),Promise.resolve()}(e.res,l,b,m,d)),t.push(p.call("gameover",e)),Promise.allSettled(t)});return function(e,t,r,n){(0,o.v)(n),n.replaceChildren();for(let o=0;o<t;o++){const t=e.createElement("div");t.className=r;const s=o+1;t.dataset.num=s,n.append(t)}}(t,l.size(),"cell",u),u.addEventListener("click",function(e){const t=a(e);if(!(t<0))return l.setActivePosition(t),i(l,u),y()},!1),f.addEventListener("click",function(e){const t=a(e);if(!(t<0))return l.setActiveDigitIndex(t),c(l,f),y()},!1),g(),{on:v,actionKeys:h,onMessage:async function(e){const{res:t,position:r,digit:s,playerId:a}={...e},c=await l.setMoveAsync(r,s,a);return n.logicDebug&&(0,o.v)(t===c.res,"Bad move"),c},redraw:g}}const d={modes:["client","ai","server","hotseat","test","swrtc","cwrtc","ssupa","csupa","cauto"],mode:"cauto",channelTypes:["socket","supa","fake","auto","none"],channelType:"auto",wsPort:8088,logger:"",serverId:"",logicDebug:!0,fastRestart:!1,colorOrder:["blue","red","green","yellow"],colors:["blue","red","green","yellow"],color:"blue",gameChanPrefix:"sos_",playerLimit:2,logLevel:2,idNameInStorage:"my-id",idNameLen:6,size:14};window.addEventListener("unhandledrejection",e=>{}),async function(r,s){const a=function(t,o){const r=new URLSearchParams(t),n=[];for(const[t,s]of r)"number"==typeof o[t]?o[t]=Number.parseInt(s,10):"boolean"==typeof o[t]?o[t]=e(s):o[t]=s,n.push(t);return n}(r.location.search,d);!function(e){e.colorOrder.length>e.playerLimit&&e.colorOrder.splice(e.playerLimit)}(d),function(e,t,o){const r=["mode"];for(const t of r)if(e.includes(t))return;new URLSearchParams(o).has("c")&&(t.mode="cwrtc")}(a,d,r.location.search);const c=(0,t.A)(s,d);let i;c.log("Choosen mode "+d.mode),"client"===d.mode?i=await n.e(334).then(n.bind(n,334)):"server"===d.mode?i=await Promise.all([n.e(826),n.e(386)]).then(n.bind(n,386)):"ai"===d.mode?i=await n.e(370).then(n.bind(n,370)):"hotseat"===d.mode?i=await n.e(659).then(n.bind(n,659)):"test"===d.mode?i=await n.e(641).then(n.bind(n,641)):"swrtc"===d.mode?i=await Promise.all([n.e(826),n.e(85),n.e(368)]).then(n.bind(n,368)):"cwrtc"===d.mode?i=await Promise.all([n.e(826),n.e(85),n.e(470)]).then(n.bind(n,470)):"cauto"===d.mode?i=await n.e(18).then(n.bind(n,18)):(0,o.v)(!1,"Unsupported mode"),i.default(r,s,d,l).catch(e=>{c.error(e)})}(window,document)})()})();